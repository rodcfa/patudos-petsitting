import{c as w}from"./index-C_6bkvJA.js";const h="https://ntvpbxdnjslfwhezjoah.supabase.co",y="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im50dnBieGRuanNsZndoZXpqb2FoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE1OTg2NDQsImV4cCI6MjA2NzE3NDY0NH0.zN37OSZOX-Ylp2Qv7UDw3w4TMdJOvPPgJhTwi1wNBeg",p=w(h,y);let a=null;const n=document.getElementById("loginForm"),c=document.getElementById("loginOptions"),u=document.getElementById("loadingOverlay"),i=document.getElementById("errorMessage"),e=document.getElementById("submitBtn");document.addEventListener("DOMContentLoaded",function(){console.log("Login Page - Iniciado"),I(),E()});function I(){n&&n.addEventListener("submit",C)}function E(){if(localStorage.getItem("adminLoggedIn")==="true"){window.location.href="index.html";return}if(localStorage.getItem("clientLoggedIn")==="true"){window.location.href="client-dashboard.html";return}}function L(){a="client",c.style.display="none",n.style.display="block",document.querySelector('label[for="username"]').textContent="Email:",document.getElementById("username").type="email",document.getElementById("username").placeholder="seu@email.com",e.innerHTML='<i class="fas fa-sign-in-alt"></i> Entrar como Cliente'}function b(){a="admin",c.style.display="none",n.style.display="block",document.querySelector('label[for="username"]').textContent="Usuário:",document.getElementById("username").type="text",document.getElementById("username").placeholder="Nome de usuário",e.innerHTML='<i class="fas fa-shield-alt"></i> Entrar como Admin'}function S(){a=null,n&&(n.style.display="none"),c&&(c.style.display="flex"),n&&n.reset(),g()}async function C(o){o.preventDefault();try{d(!0),g();const t=new FormData(n),s=t.get("username"),r=t.get("password");if(a==="admin")if(s==="RC-adm"&&r==="Gotzen1154!"){localStorage.setItem("adminLoggedIn","true"),localStorage.setItem("adminUser","RC-adm"),d(!1),window.location.href="index.html";return}else throw new Error("Credenciais de administrador inválidas");else if(a==="client"){const m=await T(r),{data:l,error:f}=await p.from("users").select("*").eq("email",s).eq("password_hash",m).eq("role","client").single();if(f||!l)throw new Error("Email ou senha incorretos");localStorage.setItem("clientLoggedIn","true"),localStorage.setItem("clientId",l.id),localStorage.setItem("clientName",l.name),localStorage.setItem("clientEmail",l.email),d(!1),window.location.href="client-dashboard.html";return}}catch(t){console.error("Erro no login:",t),d(!1),x(t.message)}}async function T(o){const s=new TextEncoder().encode(o),r=await crypto.subtle.digest("SHA-256",s);return Array.from(new Uint8Array(r)).map(m=>m.toString(16).padStart(2,"0")).join("")}function d(o){if(!(!u||!e))if(o){u.classList.add("active"),e.disabled=!0;const t=e.innerHTML;e.innerHTML='<i class="fas fa-spinner fa-spin"></i> Entrando...',e.dataset.originalText=t}else u.classList.remove("active"),e.disabled=!1,e.dataset.originalText&&(e.innerHTML=e.dataset.originalText)}function x(o){i&&(i.textContent=o,i.style.display="block")}function g(){i&&(i.style.display="none")}window.showClientLogin=L;window.showAdminLogin=b;window.showLoginOptions=S;
